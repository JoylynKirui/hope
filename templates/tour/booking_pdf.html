{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Booking Report #{{ booking.id }}</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      color: #333;
      line-height: 1.5;
      font-size: 12px;
    }

    .page {
      width: 100%;
      margin: 0 auto;
      background: white;
    }

    /* --- HERO --- */
    .hero {
      width: 100%;
      height: 120px;
      background: url("https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?auto=format&fit=crop&w=1600&q=80") 
                  no-repeat center center;
      background-size: cover;
      text-align: center;
      display: flex;
      flex-direction: column;
      justify-content: center;
      color: #fff;
    }
    .hero h1 {
      font-size: 20px;
      margin: 0;
      background: rgba(0,0,0,0.5);
      display: inline-block;
      padding: 4px 10px;
      border-radius: 4px;
    }
    .hero p {
      font-size: 12px;
      margin: 6px 0 0;
      background: rgba(0,0,0,0.4);
      display: inline-block;
      padding: 2px 8px;
      border-radius: 4px;
    }

    /* --- CONTENT --- */
    .content {
      max-width: 170mm;  /* keeps it centered and readable */
      margin: 0 auto;
      padding: 15mm 10mm;
    }
    .section {
      margin-bottom: 18px;
      page-break-inside: avoid;
    }
    .section-title {
      font-size: 14px;
      font-weight: bold;
      margin-bottom: 8px;
      border-bottom: 1px solid #003366;
      padding-bottom: 4px;
      color: #003366;
    }

    p { margin: 3px 0; }

    /* --- TABLES --- */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 5px;
      font-size: 11.5px;
    }
    th, td {
      border: 1px solid #aaa;
      padding: 5px 6px;
    }
    th { background: #eaeaea; }
    .text-end { text-align: right; }
    .text-center { text-align: center; }

    /* --- TWO-COLUMN --- */
    .two-col-content {
      width: 100%;
    }
    .two-col-content td {
      vertical-align: top;
      padding: 0 6px 10px 0;
      width: 50%;
    }
    .item-card {
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 6px;
      background: #fafafa;
    }
    .item-card img {
      width: 100%;
      height: 50mm;
      object-fit: cover;
      margin-bottom: 5px;
      display: block;
    }
    .item-card h4 {
      font-size: 12.5px;
      margin: 2px 0;
      color: #003366;
    }
    .item-card p {
      font-size: 11.5px;
      margin: 1px 0;
    }
  </style>
</head>
<body>

<div class="page">

  <!-- HERO -->
  <div class="hero">
    <h1>Africa's Leading Tour Management System</h1>
    <p>Plan, organize, and enjoy seamless travel experiences with <strong>Nomad</strong>.</p>
  </div>

  <!-- CONTENT -->
  <div class="content">
    <!-- Client Info -->
    <div class="section">
      <div class="section-title">Client Information</div>
      <p><strong>Client:</strong> {{ booking.client.first_name }} {{ booking.client.last_name }}</p>
      <p><strong>Start Date:</strong> {{ booking.start_date }}</p>
      <p><strong>End Date:</strong> {{ booking.end_date }}</p>
    </div>

    <!-- Cost Breakdown -->
    <div class="section">
      <div class="section-title">Cost Breakdown</div>
      {% with breakdown=booking.cost_breakdown %}
      <table>
        <thead>
          <tr>
            <th>Category</th>
            <th class="text-end">Cost</th>
          </tr>
        </thead>
        <tbody>
          <tr><td>Accommodation</td><td class="text-end">KSH {{ breakdown.Accommodation }}</td></tr>
          <tr><td>Activities</td><td class="text-end">KSH {{ breakdown.Activities }}</td></tr>
          <tr><td>Dining</td><td class="text-end">KSH {{ breakdown.Dining }}</td></tr>
          <tr><td>Transport</td><td class="text-end">KSH {{ breakdown.Transport }}</td></tr>
          <tr><td><strong>Total</strong></td><td class="text-end"><strong>KSH {{ breakdown.Total }}</strong></td></tr>
        </tbody>
      </table>
      {% endwith %}
    </div>

    <!-- Travel Itinerary -->
    <div class="section">
      <div class="section-title">Travel Itinerary</div>
      <table>
        <thead>
          <tr>
            <th>Date</th>
            <th>Mode</th>
            <th>From</th>
            <th>To</th>
            <th class="text-end">Cost</th>
          </tr>
        </thead>
        <tbody>
          {% for leg in travel_legs %}
          <tr>
            <td>{{ leg.date }}</td>
            <td>{{ leg.mode }}</td>
            <td>{{ leg.from_location }}{% if leg.from_destination %} ({{ leg.from_destination.name }}){% endif %}</td>
            <td>{{ leg.to_location }}{% if leg.to_destination %} ({{ leg.to_destination.name }}){% endif %}</td>
            <td class="text-end">KSH {{ leg.cost }}</td>
          </tr>
          {% empty %}
          <tr><td colspan="5" class="text-center">No travel legs added yet.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <!-- Destinations -->
    <div class="section">
      <div class="section-title">Destinations</div>
      <table class="two-col-content">
        <tr>
          {% for d in booking.destinations.all %}
          <td>
            <div class="item-card">
              {% if d.galleries.first %}
                <img src="{{ d.galleries.first.image.url }}" alt="{{ d.name }}">
              {% endif %}
              <h4>{{ d.name }}</h4>
              <p><em>{{ d.start_date }} â†’ {{ d.end_date }}</em></p>
              <p>{{ d.description }}</p>
            </div>
          </td>
          {% if forloop.counter|divisibleby:2 %}</tr><tr>{% endif %}
          {% empty %}
          <td colspan="2">No destinations added yet.</td>
          {% endfor %}
        </tr>
      </table>
    </div>

    <!-- Restaurants -->
    <div class="section">
      <div class="section-title">Restaurants</div>
      <table class="two-col-content">
        <tr>
          {% for d in booking.destinations.all %}
            {% for r in d.restaurants.all %}
              <td>
                <div class="item-card">
                  {% if r.image %}
                    <img src="{{ r.image.url }}" alt="{{ r.name }}">
                  {% endif %}
                  <h4>{{ r.name }}</h4>
                  <p>{{ r.description }}</p>
                </div>
              </td>
              {% if forloop.counter|divisibleby:2 %}</tr><tr>{% endif %}
            {% empty %}
              <td colspan="2">No restaurants added yet.</td>
            {% endfor %}
          {% endfor %}
        </tr>
      </table>
    </div>
  </div>

</div>

</body>
</html>
